<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" itemscope itemtype="https://schema.org/WebPage">
<head>
<title>Mode Control Dialog</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="docs_manual.css">
</head>
<body><script type="text/javascript" src="highlight.js"></script>
<script type="text/javascript">
	function highlightStart() { highlight(); }
	document.body.onload = highlightStart;
</script>

<div id="header">
	<div class="logo"><a href ="Top.html"><img src="ADT_LOGO.png" width="100" height="54" alt="A&amp;D Technology"/></a></div>
	<div class="name">iTest User's Guide</div>
	<div id="search-div">
		<form method="get" action="search.html">
			<input type="text" name="zoom_query" size="20" />
			<input type="submit" class="searchbutton" value="Search" />
		</form>
	</div>
</div>
<div class="clear"></div>
<div class="line-blue"></div><ul id="breadcrumb" >
<li><a href="Top.html">Home</a></li>
<li><a href="ITest_Application_Development_Guide.html">ITest Application Development Guide</a></li>
<li><a href="Managing_Proportional_Integral_Derivative_Controls.html">Managing Proportional Integral Derivative Controls</a></li>
<li><a href="Mode_Control_Dialog.html">Mode Control Dialog</a></li>
</ul>
</div>

<div class="trail"></div>

<a name="Mode-Control-Dialog"></a>
<h1 >Mode Control Dialog<a href="#Mode-Control-Dialog" class="wiki-anchor">&para;</a></h1>


	<ul class="toc right"><li><strong>Table of contents</strong></li><li><a href="#Mode-Control-Dialog">Mode Control Dialog</a><ul><li><a href="#Overview">Overview</a></li><li><a href="#Configuring-the-Mode-Control-Dialog">Configuring the Mode Control Dialog</a><ul><li><a href="#Configuring-Mode-Control-in-AutomationPanel">Configuring Mode Control in AutomationPanel</a><ul><li><a href="#Show-Ramp-Controls">Show Ramp Controls</a></li></ul>
</li><li><a href="#Configuring-Mode-Control-in-Test-Manager">Configuring Mode Control in Test Manager</a></li><li><a href="#Configuring-the-Mode-List">Configuring the Mode List</a></li></ul>
</li><li><a href="#Using-X-Mode">Using X Mode</a></li><li><a href="#See-Also">See Also</a></li></ul></li></ul>


	<a name="Overview"></a>
<h2 >Overview<a href="#Overview" class="wiki-anchor">&para;</a></h2>


	<p>The Mode Control dialog is the primary operator interface for switching control modes and manually changing setpoints. This dialog is a floating dialog on top of AutomationPanel's main window. It can be accessed in AutomationPanel by selecting <strong>Tools</strong> > <strong>Mode Control...</strong>. iTest Console has a similar dialog. For more information regarding iTest Console, refer to the <a class="wiki-page" href="PID_Control_Box.html">PID Control Box</a> documentation.</p>


	<a name="Configuring-the-Mode-Control-Dialog"></a>
<h2 >Configuring the Mode Control Dialog<a href="#Configuring-the-Mode-Control-Dialog" class="wiki-anchor">&para;</a></h2>


	<p>The Mode Control dialog can be configured using AutomationPanel or Test Manager. The <em>powertek.ini</em> settings that affect the function and appearance of the Mode Control dialog are listed below. Descriptions of these <em>powertek.ini</em> settings can be found in the <a class="wiki-page" href="Managing_Proportional_Integral_Derivative_Controls.html#Powertekini-Settings">Powertek.ini Settings</a> section.</p>


	<ul>
	<li>HS1Label</li>
		<li>HS2Label</li>
		<li>InternalPIDs</li>
		<li>TemplateCommandVisibility</li>
		<li>DetachPIDControl</li>
		<li>PIDControlLoopGroup1Name</li>
		<li>PIDControlLoopGroup2Name</li>
	</ul>


	<p>In addition, there are several Softpanel mailslot messages that can be used to configure the appearance and behavior of the PID Control Box during runtime. The following table describes the mailslot messages:</p>


	<p style="font-size: 11px;margin-left: 3em;"><em><strong>Mailslot Messages</strong></em></p>


	<table style="margin-left: 2.5em;width:800px;">
		<tr style="padding-bottom:1em;background:#cccaca;">
			<td style="width:125px;text-align:left;"><strong>Mailslot Message</strong> </td>
			<td style="text-align:left;"><strong>Description</strong> </td>
		</tr>
		<tr>
			<td>$SHOWPIDCONTROL</td>
			<td>Shows the PID Control dialog.</td>
		</tr>
		<tr>
			<td>$HIDEPIDCONTROL</td>
			<td>Hides the PID Control (can be restored via the menu)</td>
		</tr>
		<tr>
			<td>$RAMP</td>
			<td>This one brings up the manual ramp interface on the PID control box.</td>
		</tr>
		<tr>
			<td>$RAMPOFF</td>
			<td>Turns off the manual ramp interface.</td>
		</tr>
		<tr>
			<td>$AUTO</td>
			<td>Disables the PID Control dialog box. </td>
		</tr>
		<tr>
			<td>$MANUAL</td>
			<td>Re-enables the PID Control dialog box. </td>
		</tr>
	</table>




	<p>The Mode Control dialog's drop-down menu is populated from the <em>mode.lst</em> file, and this file is modified using the Control Mode editor found in Test Manager or SolutionBuilder.</p>


	<a name="Configuring-Mode-Control-in-AutomationPanel"></a>
<h3 >Configuring Mode Control in AutomationPanel<a href="#Configuring-Mode-Control-in-AutomationPanel" class="wiki-anchor">&para;</a></h3>


	<p>To configure the Mode Control dialog in AutomationPanel, do the following:</p>


	<ol>
	<li>Open <strong>Tools</strong> > <strong>Mode Configuration...</strong>. This opens the Mode Control dialog. </li>
		<li>Click the hamburger-icon in the upper-right corner then select <strong>Properties</strong>.<br />&nbsp;<br /><span style="font-size: 11px;padding-left: 1.5em;"> <em><strong>Mode Control Dialog</strong></em></span><br /><img src="attachments/download/97193/42_ModeControlDialogProperties.png" style="padding-top:0.5em;padding-bottom:1em;padding-left:1em;" alt="" /><br />&nbsp;</li>
		<li>Use the descriptions provided in the table below to configure the Mode Control dialog.</li>
	</ol>


	<p style="font-size: 11px;margin-left: 3em;"><em><strong>Mode Control Properties</strong></em></p>


	<table style="margin-left: 2.5em;width:800px;">
		<tr style="padding-bottom:1em;background:#cccaca;">
			<td style="text-align:left;"><strong>Property</strong></td>
			<td style="text-align:left;"><strong>Description</strong></td>
		</tr>
		<tr style="background:#ededed;">
			<th style="text-align:center;" colspan="2">X Mode</th>
		</tr>
		<tr>
			<td>(D)erivative Gain</td>
			<td>The derivative gain value.</td>
		</tr>
		<tr>
			<td>(I)ntegral Gain</td>
			<td>The integral gain value.</td>
		</tr>
		<tr>
			<td>(P)roptional Gain</td>
			<td>The proportional gain value.</td>
		</tr>
		<tr>
			<td>Feedback Channel</td>
			<td>    Select the feedback channel associated with the control loop. The fields to the right of this option reflect the Low and High EU values for the selected database channel. Note that if the channel selected is not valid, then an error message will display.</td>
		</tr>
		<tr>
			<td>Reverse Acting</td>
			<td>Enable this option to ensure that the control output is adjusted in the correct direction when an increase in the control output causes a decrease in the feedback value (e.g., opening a chiller flow control valve decreases the temperature of the chilled fluid).</td>
		</tr>
		<tr>
			<td>Setpoint Max</td>
			<td>The control loop's maximum setpoint.</td>
		</tr>
		<tr>
			<td>Setpoint Min</td>
			<td>The control loop's minimum setpoint.</td>
		</tr>
		<tr style="background:#ededed;">
			<th style="text-align:center;" colspan="2">Dyno</th>
		</tr>
		<tr>
			<td>Line Rate</td>
			<td>Sets the rate when controlling with the left and right arrow keys.</td>
		</tr>
		<tr>
			<td>Page Rate</td>
			<td>Sets the rate when using the page up/down buttons to change the setpoint.</td>
		</tr>
		<tr style="background:#ededed;">
			<th style="text-align:center;" colspan="2">Throttle</th>
		</tr>
		<tr>
			<td>Line Rate</td>
			<td>Sets the rate when controlling with the left and right arrow keys.</td>
		</tr>
		<tr>
			<td>Page Rate</td>
			<td>Sets the rate when using the page up/down buttons to change the setpoint.</td>
		</tr>
	</table>




	<a name="Show-Ramp-Controls"></a>
<h4 >Show Ramp Controls<a href="#Show-Ramp-Controls" class="wiki-anchor">&para;</a></h4>


	<p>In AutomationPanel, you can show the manual ramp controls using the Mode Control dialog. To display the manual ramp controls, click the hamburger icon in the Mode Control dialog then select <strong>Show Ramp Controls</strong>. The Mode Control dialog expands to display the manual ramp controls.</p>


	<p><span style="font-size: 11px;padding-left: 3em;"> <em><strong>Show Ramp Controls</strong></em></span><br /><img src="attachments/download/97194/42_EnableRampControls.png" style="padding-top:0.5em;padding-bottom:1em;padding-left: 2.30em;" alt="" /><br />&nbsp;<br /><span style="font-size: 11px;padding-left: 3em;"> <em><strong>Manual Ramp Controls</strong></em></span><br /><img src="attachments/download/97195/42_ManualRampControls.png" style="padding-top:0.5em;padding-bottom:1em;padding-left: 2.30em;" alt="" /></p>


	<p>Use the descriptions provided in the table below to configure the ramp controls.</p>


	<p style="font-size: 11px;margin-left: 3em;"><em><strong>Manual Ramp Controls Descriptions</strong></em></p>


	<table style="margin-left: 2.5em;">
		<tr style="padding-bottom:1em;background:#cccaca;">
			<td style="text-align:left;"><strong>Control</strong></td>
			<td style="text-align:left;"><strong>Description</strong></td>
		</tr>
		<tr>
			<td>Target</td>
			<td>The target value.</td>
		</tr>
		<tr>
			<td>Time (sec)</td>
			<td>The amount of time to reach the target value before switching controls.</td>
		</tr>
		<tr>
			<td>Begin Ramp</td>
			<td>Starts the ramp.</td>
		</tr>
		<tr>
			<td>Stop Ramp</td>
			<td>Stops the ramp.</td>
		</tr>
		<tr>
			<td>Close Ramp</td>
			<td>Closes the manual ramp controls.</td>
		</tr>
	</table>




	<a name="Configuring-Mode-Control-in-Test-Manager"></a>
<h3 >Configuring Mode Control in Test Manager<a href="#Configuring-Mode-Control-in-Test-Manager" class="wiki-anchor">&para;</a></h3>


	<p>To configure the Mode Control dialog in Test Manager, do the following:</p>


	<ol>
	<li>Select the <strong>Global settings</strong> node in Test Manager.</li>
		<li>Using the drop-down menu, select <strong>PIDs</strong>.<br />&nbsp;<br /><span style="font-size: 11px;padding-left: 1.5em;"> <em><strong>Global Settings - PIDs</strong></em></span><br /><img src="attachments/download/97196/42_PIDGlobalSettings.png" style="padding-top:0.5em;padding-bottom:1em;padding-left:1em;" alt="" /><br />&nbsp;</li>
		<li>Use the descriptions provided in the table below to configure the Mode Control dialog. Note that these settings can also be found in the <em>powertek.ini</em> settings.</li>
	</ol>


	<p style="font-size: 11px;margin-left: 3em;"><em><strong>Mode Control Properties</strong></em></p>


	<table style="margin-left: 2.5em;width:800px;">
		<tr style="padding-bottom:1em;background:#cccaca;">
			<td style="text-align:left;"><strong>Powertek.ini Entry</strong></td>
			<td style="text-align:left;"><strong>Description</strong></td>
		</tr>
		<tr>
			<td>HS1Label</td>
			<td>Label for PID Left Mode Control.</td>
		</tr>
		<tr>
			<td>HS2Label</td>
			<td>Label for PID Right Mode Control.</td>
		</tr>
		<tr>
			<td>PidControlLoopGroup1Name</td>
			<td>PID group to use for the left side of the Mode Control dialog.</td>
		</tr>
		<tr>
			<td>PidControlLoopGroup2Name</td>
			<td>PID Group to use for the right side of the Mode Control dialog.</td>
		</tr>
		<tr>
			<td>InternalPids</td>
			<td>Enable Mode Control combo box.</td>
		</tr>
		<tr>
			<td>LastModeHS1</td>
			<td>Initial PID to start for PID Group HS1.</td>
		</tr>
		<tr>
			<td>LastModeHS2</td>
			<td>Initial PID to start for PID Group HS2.</td>
		</tr>
		<tr>
			<td>TemplateCommandVisibility</td>
			<td>Enable the Mode Control dialog.</td>
		</tr>
		<tr>
			<td>DefaultPIDGroup</td>
			<td>Name of the PID group to apply at startup.</td>
		</tr>
		<tr>
			<td>StartPids</td>
			<td>Enable PIDs at startup.</td>
		</tr>
		<tr>
			<td>PIDGlobalGainChan</td>
			<td>Name of a channel that contains the global gain value for multiplying PID coefficients.</td>
		</tr>
		<tr>
			<td>ReportPidModeSwitchErrors</td>
			<td>Report invalid mode pair messages.</td>
		</tr>
	</table>




	<a name="Configuring-the-Mode-List"></a>
<h3 >Configuring the Mode List<a href="#Configuring-the-Mode-List" class="wiki-anchor">&para;</a></h3>


	<p>The <em>mode.lst</em> file is configured using the Control Modes editor in Test Manager or SolutionBuilder. For more information on how to configure the <em>mode.lst</em> file, refer to the following documents:</p>


	<ul>
	<li><a class="wiki-page" href="Control_Loops.html#Control-Modes">Control Modes in Test Manager</a></li>
		<li><a class="wiki-page" href="Control_Loops_in_SolutionBuilder.html#Control-Modes">Control Modes in SolutionBuilder</a></li>
	</ul>


	<a name="Using-X-Mode"></a>
<h2 >Using X Mode<a href="#Using-X-Mode" class="wiki-anchor">&para;</a></h2>


	<p>The standard modes for dyno/throttle modules are:</p>


	<p><strong>Spd/Pos Spd/Trq Trq/Pos Trq/Spd</strong></p>


	<p>There is also a <strong>Runtime Configurable</strong> mode in which the user can select the feedback channel for the throttle PID. When this is utilized, the mode set will change to the following, for example:</p>


	<p><strong>Spd/Pos Spd/Trq Spd/X Trq/Pos Trq/Spd Trq/X</strong></p>


	<p>The X loop is added to the throttle loop group and the mode list is extended to provide 2 new mode pairs, as shown in the following screenshots:<br />&nbsp;<br /><span style="font-size: 11px;padding-left: 3em;"> <em><strong>X Mode</strong></em></span><br /><img src="attachments/download/97112/pidnew1.png" style="padding-top:0.5em;padding-bottom:1em;padding-left: 2.30em;" alt="" /><br />&nbsp;<br /><span style="font-size: 11px;padding-left: 3em;"> <em><strong>Control Modes</strong></em></span><br /><img src="attachments/download/97111/pidnew2.png" style="padding-top:0.5em;padding-bottom:1em;padding-left: 2.30em;" alt="" /><br />&nbsp;</p>


	<p>The Mode Control dialog will have new modes available in the mode list, as shown below:<br />&nbsp;<br /><span style="font-size: 11px;padding-left: 3em;"> <em><strong>Select Mode</strong></em></span><br /><img src="attachments/download/97613/XmodeAP1.PNG" style="padding-top:0.5em;padding-bottom:1em;padding-left: 2.30em;" alt="" /><br />&nbsp;<br />The Mode Control dialog will have a set of configurable properties (detailed above), accessed via the Property Manager as shown below:<br />&nbsp;<br /><span style="font-size: 11px;padding-left: 3em;"> <em><strong>X Mode Property Manager</strong></em></span><br /><img src="attachments/download/97616/XmodeAP3.PNG" style="padding-top:0.5em;padding-bottom:1em;padding-left: 2.30em;" alt="" /><br />&nbsp;</p>


	<p>The X mode PID mode is identified by a <em>powertek.ini</em> setting, as shown below:</p>


<pre>PidXMode=X.Dt1Throt</pre>

	<p>If this setting is not present in the <em>powertek.ini</em> or has an empty value, the X Mode properties will not be available in the Property Manager dialog.</p>


	<p>If an X loop is selected (from Mode Control), the X Mode properties will be visible but editing the configuration will not be possible.</p>


	<p>Using the Property Manager, the user picks the feedback value, the loop direction, the PID gains, and the setpoint limits. If the channel has been used in X Mode before, the values are loaded from the new file <em>xmode.lst</em>. If not, default PID values and loop direction are used and the min and max setpoint values are loaded from the feedback channelâ€™s min and max EU values.</p>


	<p><span style="font-size: 11px;padding-left: 3em;"> <em><strong>X Mode Configuration</strong></em></span><br /><img src="attachments/download/97614/XmodeAP2.PNG" style="padding-top:0.5em;padding-bottom:1em;padding-left: 2.30em;" alt="" /></p>


	<p>Modifying the properties writes the changes to the mode file defined as the X mode file in <em>powertek.ini</em>, and writes the new values to the file <em>xmode.lst</em>. In addition, you can hook a procedure to get called when changes to the X Mode properties are made. Set the <em>powertek.ini</em> setting PIDXModeSaveProcedure to the name of the procedure you would like to call.</p>


	<a name="See-Also"></a>
<h2 >See Also<a href="#See-Also" class="wiki-anchor">&para;</a></h2>


	<ul>
	<li><a class="wiki-page" href="PID_Control_Box.html">iTest Console PID Control dialog</a></li>
	</ul>
</body>
</html>
