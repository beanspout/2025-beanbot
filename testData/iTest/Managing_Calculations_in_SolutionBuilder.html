<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" itemscope itemtype="https://schema.org/WebPage">
<head>
<title>Managing Calculations in SolutionBuilder</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="docs_manual.css">
</head>
<body><script type="text/javascript" src="highlight.js"></script>
<script type="text/javascript">
	function highlightStart() { highlight(); }
	document.body.onload = highlightStart;
</script>

<div id="header">
	<div class="logo"><a href ="Top.html"><img src="ADT_LOGO.png" width="100" height="54" alt="A&amp;D Technology"/></a></div>
	<div class="name">iTest User's Guide</div>
	<div id="search-div">
		<form method="get" action="search.html">
			<input type="text" name="zoom_query" size="20" />
			<input type="submit" class="searchbutton" value="Search" />
		</form>
	</div>
</div>
<div class="clear"></div>
<div class="line-blue"></div><ul id="breadcrumb" >
<li><a href="Top.html">Home</a></li>
<li><a href="Developer_Tools.html">Developer Tools</a></li>
<li><a href="Managing_Calculations_in_SolutionBuilder.html">Managing Calculations in SolutionBuilder</a></li>
</ul>
</div>

<div class="trail"></div>

<a name="Managing-Calculations"></a>
<h1 >Managing Calculations<a href="#Managing-Calculations" class="wiki-anchor">&para;</a></h1>


	<ul class="toc right"><li><strong>Table of contents</strong></li><li><a href="#Managing-Calculations">Managing Calculations</a><ul><li><a href="#Overview">Overview</a></li><li><a href="#Continuous-Calculations">Continuous Calculations</a><ul><li><a href="#Calculation-Rates">Calculation Rates</a></li><li><a href="#Syntax">Syntax</a></li></ul>
</li><li><a href="#Using-the-Calculations-Editor">Using the Calculations Editor</a></li><li><a href="#Adding-Calculations">Adding Calculations</a></li><li><a href="#Build-Output-Bar">Build Output Bar</a></li><li><a href="#Ordering-Calculations">Ordering Calculations</a><ul><li><a href="#Ordering-Module-Calculations">Ordering Module Calculations</a></li></ul></li></ul></li></ul>


	<a name="Overview"></a>
<h2 >Overview<a href="#Overview" class="wiki-anchor">&para;</a></h2>


	<p>Calculations are a series of periodically calculated formulas. The calculated results are stored as channel values that can be logged, displayed, verified for limits and quality, and more. The following sections describe how to use SolutionBuilder to create and edit calculations. For more information, refer to the <a class="wiki-page" href="Calculations.html">Calculations</a> documentation.</p>


	<p><a name="Continuous-Calculations"></a>
<h2 >Continuous Calculations<a href="#Continuous-Calculations" class="wiki-anchor">&para;</a></h2>


	<p>Continuous calculations begin as soon as iTest is initialized and continue until the system is exited. Calculations are stored in separate files within folders that represent the rate of calculations. The following calculation folders are available, by default:</p>


	<ul>
	<li>1 Hz</li>
		<li>10 Hz</li>
		<li>100 Hz</li>
		<li>System Rate</li>
	</ul>


	<p>For the 1000 Hz calculation folder to appear, the <code>Support1kHz</code> <em>powertek.ini</em> setting must be set to TRUE.</p>


	<a name="Calculation-Rates"></a>
<h3 >Calculation Rates<a href="#Calculation-Rates" class="wiki-anchor">&para;</a></h3>


	<p>By default, iTest calculations are supported at the following rates: 1 Hz, 10 Hz, 100 Hz, or system rate. To support calculations at a rate up to 1000 Hz, the <code>Support1kHz</code> <em>powertek.ini</em> option must be set to TRUE, and it must be running on a dedicated machine with a real-time operating system. A special task executes and enables the scanning of PIDs, logging, and calculations at rates up to 1000 Hz.</p>


	<p>Calculations are executed in the following priority:</p>


	<ol>
	<li>1000 Hz</li>
		<li>System Rate</li>
		<li>100 Hz</li>
		<li>10 Hz</li>
		<li>1 Hz</li>
	</ol>


	<p><table>
		<tr>
			<td style="background:#ebd700;"></td>
			<td style="vertical-align:top;"><img src="attachments/download/3740/caution.gif" alt="" /></td>
			<td style="vertical-align:top;"><b>CAUTION:</b></td>
			<td style="vertical-align:top;">Calculations running at 1000 Hz have the potential to slow the system. Calculations that involve strings are CPU intensive and should be calculated at 10 Hz or 1 Hz.</td>
		</tr>
	</table></p>


	<a name="Syntax"></a>
<h3 >Syntax<a href="#Syntax" class="wiki-anchor">&para;</a></h3>


	<p>Calculations use the following format:<br /><pre>
&lt;ChannelName&gt; &lt;Formula&gt;
</pre><br />The destination channel name and expression must be separated by a blank space character. This character is an implied equal sign; you do not need to include an equal sign between the channel name and the expression.</p>


	<p><table>
		<tr>
			<td style="background:#336699;"></td>
			<td style="vertical-align:top;"><img src="attachments/download/3553/Notepad.png" alt="" /></td>
			<td style="vertical-align:top;"><b>NOTE:</b></td>
			<td style="vertical-align:top;">A single line in the Calculations editor cannot exceed 1023 bytes.</td>
		</tr>
	</table></p></p>


	<a name="Using-the-Calculations-Editor"></a>
<h2 >Using the Calculations Editor<a href="#Using-the-Calculations-Editor" class="wiki-anchor">&para;</a></h2>


	<p>To manage calculations in SolutionBuilder, select <strong>Tests > Calculations</strong> from SolutionBuilder’s main menu to open the Calculations editor. The Calculations editor contains four sections: the list of calculations, the helper bar, the editing area, and the build output bar.</p>


	<p><span style="font-size: 11px;padding-left: 3em;"> <em><strong>Calculations Editor</strong></em></span><br /><img src="attachments/download/133897/45_CalculationsEditor.png" style="padding-top:0.5em;padding-bottom:1em;padding-left: 2.30em;" alt="" /><br />&nbsp;</p>


	<p>The following right-click options available in the list of calculations:</p>


	<p style="font-size: 11px;margin-left: 3em;"><em><strong>Right-Click Options</strong></em></p>


	<table style="margin-left: 2.5em;width: 800px;">
		<tr style="padding-bottom:1em;background:#cccaca;">
			<td style="text-align:left;"><strong>Option</strong></td>
			<td style="text-align:left;"><strong>Description</strong></td>
		</tr>
		<tr>
			<td>Add</td>
			<td> Adds a new calculation. For more information, refer to the <a class="wiki-page" href="#Adding-Calculations">Adding Calculations</a> section below.</td>
		</tr>
		<tr>
			<td>Remove</td>
			<td> Removes the selected calculation.</td>
		</tr>
		<tr>
			<td>Calculation Order…</td>
			<td> Changes the order that calculations are executed within a calculation rate folder. For more information, refer to <a class="wiki-page" href="#Ordering-Calculations">Ordering Calculations</a> section below.</td>
		</tr>
		<tr>
			<td>Rename…</td>
			<td> Launches the Rename dialog, which allows you to rename the calculation.</td>
		</tr>
		<tr>
			<td>Duplicate</td>
			<td> Duplicates the selected calculation.</td>
		</tr>
		<tr>
			<td>Cut</td>
			<td> Removes the selected calculation and copies it to the clipboard.</td>
		</tr>
		<tr>
			<td>Copy</td>
			<td> Copies the selected calculation to the clipboard.</td>
		</tr>
		<tr>
			<td>Paste</td>
			<td> Pastes the copied calculation.</td>
		</tr>
		<tr>
			<td>Undo</td>
			<td> Undoes the last action.</td>
		</tr>
		<tr>
			<td>Redo</td>
			<td> Redoes the last undone action.</td>
		</tr>
	</table>




	<p>The following options are available when you right-click in the editing area:</p>


	<p style="font-size: 11px;margin-left: 3em;"><em><strong>Right-Click Edit Options</strong></em></p>


	<table style="margin-left: 2.5em;width:800px;">
		<tr style="padding-bottom:1em;background:#cccaca;">
			<td style="width:125px;text-align:left;"><strong>Option</strong> </td>
			<td style="text-align:left;"><strong>Description</strong> </td>
			<td style="width:115px;text-align:left;"><strong>Shortcut Key</strong> </td>
		</tr>
		<tr>
			<td>Cut</td>
			<td>Removes the selected text from the editor and copies it to the clipboard.</td>
			<td><strong>CTRL + X</strong></td>
		</tr>
		<tr>
			<td>Copy</td>
			<td>Copies selected text in the editor.</td>
			<td><strong>CTRL + V</strong></td>
		</tr>
		<tr>
			<td>Paste</td>
			<td>Pastes copied/cut text in the editor.</td>
			<td><strong>CTRL + P</strong></td>
		</tr>
		<tr>
			<td>Find...</td>
			<td>Launches the Find and Replace dialog with the Find tab displayed.</td>
			<td><strong>CTRL + F</strong></td>
		</tr>
		<tr>
			<td>Replace...</td>
			<td>Launches the Find and Replace dialog with the Replace tab displayed.</td>
			<td><strong>CTRL + H</strong></td>
		</tr>
		<tr>
			<td>Toggle Whitespace</td>
			<td>Turns whitespace markings on/off.</td>
			<td><strong>CTRL + W</strong></td>
		</tr>
		<tr>
			<td>Make Uppercase</td>
			<td>Makes selected text uppercase.</td>
			<td><strong>CTRL + SHIFT + U</strong></td>
		</tr>
		<tr>
			<td>Make Lowercase</td>
			<td>Makes selected text lowercase.</td>
			<td><strong>CTRL + U</strong></td>
		</tr>
		<tr>
			<td>Comment</td>
			<td>Comments out a line of text in the calculation. Text does not need to be selected or highlighted to comment it out.</td>
			<td style="text-align:center;">-</td>
		</tr>
		<tr>
			<td>Uncomment</td>
			<td>Uncomments a line of text in the calculation.</td>
			<td style="text-align:center;">-</td>
		</tr>
		<tr>
			<td>Undo</td>
			<td>Undoes the last action.</td>
			<td><strong>CTRL + Z</strong></td>
		</tr>
		<tr>
			<td>Redo</td>
			<td>Redoes the last undone action.</td>
			<td><strong>CTRL + Y</strong></td>
		</tr>
		<tr>
			<td>Open Procedure</td>
			<td>Opens the procedure based on the text that was clicked on. If the text clicked on is not a name of a procedure, then a dialog displays, indicating that SolutionBuilder cannot find the procedure. The procedures that can be opened via this right-click option are limited to the list of procedures found in the left pane.</td>
			<td style="text-align:center;">-</td>
		</tr>
		<tr>
			<td>Next Bookmark</td>
			<td>Navigates to the next bookmark in the procedure.</td>
			<td><strong>F2</strong></td>
		</tr>
		<tr>
			<td>Previous Bookmark</td>
			<td>Navigates to the previous bookmark in the procedure.</td>
			<td><strong>Shift + F2</strong></td>
		</tr>
		<tr>
			<td>Preferences...</td>
			<td>Launches the Editor Properties dialog, which enables you to modify the appearance of the editor. You can customize the font style and size, display line numbers, and enable outlines for blocks of code.</td>
			<td style="text-align:center;">-</td>
		</tr>
	</table>




	<p>&nbsp;</p>


	<a name="Adding-Calculations"></a>
<h2 >Adding Calculations<a href="#Adding-Calculations" class="wiki-anchor">&para;</a></h2>


	<p>To add a new calculation, do the following:</p>


	<ol>
	<li>Expand the folder for the rate you want the calculation to run.</li>
		<li>Right-click the folder and select <strong>Add</strong>. A blank calculation sheet displays in the editing area.<br />&nbsp;<br /><span style="font-size: 11px;padding-left: 1.5em;"> <em><strong>Add Calculation</strong></em></span><br /><img src="attachments/download/119210/43_AddCalculationOption.png" style="padding-top:0.5em;padding-bottom:1em;padding-left:1em;" alt="" /><br />&nbsp;<br /><span style="font-size: 11px;padding-left: 1.5em;"> <em><strong>New Calculation</strong></em></span><br /><img src="attachments/download/133898/45_NewCalculation.png" style="padding-top:0.5em;padding-bottom:1em;padding-left:1em;" alt="" /><br />&nbsp;</li>
		<li>Enter the calculation using VCL code in the editing area. You can use the helper bar to drag and drop channel names, commands, functions, and mailslot messages into the editing area. <ins><strong>Note:</strong></ins> The use of <code>#if</code> logic is supported in calculations; however, <code>#while</code> loop functionality is not permitted. For more information about VCL functions that can be used in your calculations, refer to the following documents: <a class="wiki-page" href="VCL_Function_List.html">VCL Function List</a>, <a class="wiki-page" href="VCL_Math_and_Conversion_Functions.html">VCL Math and Conversion Functions</a>, <a class="wiki-page" href="VCL_Miscellaneous_Functions.html">VCL Miscellaneous Functions</a>.<br />&nbsp;<br /><span style="font-size: 11px;padding-left: 1.5em;"> <em><strong>Example of a 10 Hz Calculation</strong></em></span><br /><img src="attachments/download/133899/45_ExampleCalculation.png" style="padding-top:0.5em;padding-bottom:1em;padding-left:1em;" alt="" /><br />&nbsp;</li>
	</ol>


	<a name="Build-Output-Bar"></a>
<h2 >Build Output Bar<a href="#Build-Output-Bar" class="wiki-anchor">&para;</a></h2>


	<p>If there are any test build errors while building the solution, then these errors will display in the Build Output Bar at the bottom of the Calculations editor. In addition, any calculations that contain errors will display in red font in the list.</p>


	<p><span style="font-size: 11px;padding-left: 3em;"> <em><strong>Example: Calculation with Errors</strong></em></span><br /><img src="attachments/download/133910/45_CalculationsWithErrors.png" style="padding-top:0.5em;padding-bottom:1em;padding-left: 2.30em;" alt="" /><br />&nbsp;</p>


	<p><a name="Ordering-Calculations"></a>
<h2 >Ordering Calculations<a href="#Ordering-Calculations" class="wiki-anchor">&para;</a></h2>


	<p>You can change the order that calculations are executed within a calculation rate folder. This enables you to have a finer control over the order that the files are run. Calculations can only be ordered within a specific rate. In other words, you cannot order 10 Hz and 100 Hz calculations. <br />To modify the calculation order for a specific folder rate, right-click on a folder and select Order Calculations. This opens the Calculation Order dialog, where you can drag and drop the calculation files to reorder when the calculations are executed.</p>


	<p><span style="font-size: 11px;padding-left: 3em;"> <em><strong>Ordering Calculations</strong></em></span><br /><img src="attachments/download/117204/43_OrderCalculations.gif" style="padding-top:0.5em;padding-bottom:1em;padding-left: 2.30em;" alt="" /></p>


	<p>When finished, click <strong>OK</strong>. Note that the new order is not reflected visually in the list of calculations.</p>


	<a name="Ordering-Module-Calculations"></a>
<h3 >Ordering Module Calculations<a href="#Ordering-Module-Calculations" class="wiki-anchor">&para;</a></h3>


	<p>In addition to the manual reordering of your solution’s calculations, module calculations can be controlled by defining the process order value of each module. A lower process order number places the module’s calculations earlier in the calculation loop. By default, new modules have a process order of 2 and the calculations in the system module have an order of 1. Without adjusting these values, the calculations in the base system occur prior to the calculations in the modules.</p>


	<table>
		<tr>
			<td style="background:#336699;"></td>
			<td style="vertical-align:top;"><img src="attachments/download/3553/Notepad.png" alt="" /></td>
			<td style="vertical-align:top;"><b>NOTE:</b></td>
			<td style="vertical-align:top;">If two modules have the same order, the order by which they are processed is indeterminate.</td>
		</tr>
	</table>




	<p>&nbsp;</p></p>
</body>
</html>
